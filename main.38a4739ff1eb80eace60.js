(()=>{"use strict";function t(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var s=n.call(t,e||"default");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}const e=class{constructor(e,n,s){t(this,"_handleLikeButtonClick",(()=>{this._likeButton.classList.toggle("element__button_active")})),t(this,"_handleDeleteButtonClick",(()=>{this._element.remove(),this._element=null})),t(this,"_handleImageClick",(()=>{this._handleCardClick(this._data)})),this._data=e,this._templateSelector=n,this._handleCardClick=s,this._element=this._getTemplate(),this._likeButton=this._element.querySelector(".element__button"),this._deleteButton=this._element.querySelector(".element__thrash-button"),this._cardImage=this._element.querySelector(".element__img"),this._setEventListeners()}_getTemplate(){return document.querySelector(this._templateSelector).content.querySelector(".element").cloneNode(!0)}_setEventListeners(){this._likeButton.addEventListener("click",this._handleLikeButtonClick),this._deleteButton.addEventListener("click",this._handleDeleteButtonClick),this._cardImage.addEventListener("click",this._handleImageClick)}generateCard(){const{name:t,link:e}=this._data;return this._cardImage.src=e,this._cardImage.alt=t,this._element.querySelector(".element__title").textContent=t,this._element}};const n=class{constructor(t,e){this._config=t,this._formElement=e,this._inputList=Array.from(this._formElement.querySelectorAll(this._config.inputSelector)),this._submitButton=this._formElement.querySelector(this._config.submitButtonSelector)}_showInputError(t,e){const n=t.nextElementSibling;n.textContent=e,n.classList.add(this._config.errorClass),t.classList.add(this._config.inputErrorClass)}_hideInputError(t){const e=t.nextElementSibling;e.textContent="",e.classList.remove(this._config.errorClass),t.classList.remove(this._config.inputErrorClass)}_checkInputValidity(t){if(t.validity.valid)this._hideInputError(t);else{const e=t.validationMessage;this._showInputError(t,e)}}toggleButtonState(){this._hasInvalidInput()?(this._submitButton.disabled=!0,this._submitButton.classList.add(this._config.inactiveButtonClass)):(this._submitButton.disabled=!1,this._submitButton.classList.remove(this._config.inactiveButtonClass))}_hasInvalidInput(){return this._inputList.some((t=>!t.validity.valid))}_setEventListeners(){this._inputList.forEach((t=>{t.addEventListener("input",(()=>{this._checkInputValidity(t),this.toggleButtonState()}))}))}enableValidation(){this._setEventListeners(),this.toggleButtonState()}resetValidation(){this._inputList.forEach((t=>{this._hideInputError(t)})),this.toggleButtonState()}};const s=class{constructor(t){this._popup=document.querySelector(t),this._handleEscClose=this._handleEscClose.bind(this)}_handleEscClose(t){"Escape"===t.key&&this.close()}open(){this._popup.classList.add("popup_opened"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popup.classList.remove("popup_opened"),document.removeEventListener("keydown",this._handleEscClose)}setEventListeners(){this._popup.addEventListener("click",(t=>{(t.target.classList.contains("popup")||t.target.classList.contains("popup__close"))&&this.close()}))}};const i=class extends s{constructor(t){super(t),this._popupImage=this._popup.querySelector(".popup__img"),this._popupCaption=this._popup.querySelector(".popup__card-name")}open(t){this._popupImage.src=t.link,this._popupImage.alt=t.name,this._popupCaption.textContent=t.name,super.open()}};const o=class extends s{constructor(t,e,n){super(t),this._submitHandler=e,this._form=this._popup.querySelector(".popup__form"),this._inputs=Array.from(this._form.querySelectorAll(".popup__input"))}_getInputValues(){const t={};return this._inputs.forEach((e=>{t[e.name]=e.value})),t}setEventListeners(){super.setEventListeners(),this._form.addEventListener("submit",(t=>{t.preventDefault(),this._submitHandler(this._getInputValues())}))}close(){super.close(),this._form.reset()}};const r=class{constructor(t){let{nameSelector:e,bioSelector:n}=t;this._nameElement=document.querySelector(e),this._bioElement=document.querySelector(n)}getUserInfo(){return{name:this._nameElement.textContent,bio:this._bioElement.textContent}}setUserInfo(t){let{name:e,bio:n}=t;this._nameElement.textContent=e,this._bioElement.textContent=n}};const l=class{constructor(t,e){let{renderer:n}=t;this._renderer=n,this._container=document.querySelector(e)}renderItems(t){t.forEach((t=>{this._renderer(t)}))}addItem(t){this._container.prepend(t)}},u=document.querySelector(".profile__edit-button"),a=document.querySelector(".profile__add-button"),c=document.querySelector(".popup__form_edit"),p=document.querySelector(".popup__form_add"),_=(document.querySelector(".elements"),new i(".popup_type-card"));_.setEventListeners();const d=new n({inputSelector:".popup__input",submitButtonSelector:".popup__button",inactiveButtonClass:"popup__button_disabled",inputErrorClass:"popup__input_type_error",errorClass:"popup__error_visible"},p),h=new o(".popup_type-add",(t=>{!function(t){const e=f(t);E.addItem(e)}(t),h.close()}));h.setEventListeners();const m=new r({nameSelector:".profile__title",bioSelector:".profile__bio"}),v=new n({inputSelector:".popup__input",submitButtonSelector:".popup__button",inactiveButtonClass:"popup__button_disabled",inputErrorClass:"popup__input_type_error",errorClass:"popup__error_visible"},c);function f(t){const n=new e(t,"#card-template",(()=>function(t){_.open(t)}(t)));return n.generateCard()}a.addEventListener("click",(()=>{d.resetValidation(),h.open()}));const E=new l({items:initialCards,renderer:t=>{const e=f(t);E.addItem(e)}},".elements");E.renderItems(initialCards);const b=c.querySelector(".popup__input_type_name"),g=c.querySelector(".popup__input_type_bio"),y=new o(".popup_type-edit",(t=>{!function(t){m.setUserInfo(t),y.close()}(t),y.close()}));y.setEventListeners(),v.enableValidation(),d.enableValidation(),u.addEventListener("click",(()=>function(){const t=m.getUserInfo();b.value=t.name,g.value=t.bio,y.open()}())),a.addEventListener("click",(()=>h.open()))})();